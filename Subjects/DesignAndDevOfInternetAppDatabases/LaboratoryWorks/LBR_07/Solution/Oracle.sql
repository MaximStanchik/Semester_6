-- Добавили столбцы и таблицы, чтобы можно было выполнять задание:

ALTER TABLE ORDERS ADD (
    FUEL_CONSUMPTION NUMBER(10, 2), 
    FUEL_COST NUMBER(10, 2)          
);

CREATE TABLE FUEL_COSTS (
    ID NUMBER(4) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    MONTH NUMBER(2) NOT NULL,          
    YEAR NUMBER(4) NOT NULL,          
    PRICE_PER_LITER NUMBER(10, 2) NOT NULL 
);

ALTER TABLE SERVICES ADD (
    FUEL_COST_FACTOR NUMBER(10, 2) DEFAULT 1.0 
);

INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (1, 2023, 1.50);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (2, 2023, 1.55);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (3, 2023, 1.60);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (4, 2023, 1.65);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (5, 2023, 1.70);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (6, 2023, 1.75);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (7, 2023, 1.80);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (8, 2023, 1.85);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (9, 2023, 1.90);
INSERT INTO FUEL_COSTS (MONTH, YEAR, PRICE_PER_LITER) VALUES (10, 2023, 1.95);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (1, 1, 1, 1, 'Completed', TIMESTAMP '2025-03-15 12:05:11.152', 1, 'Fun Express', 100, 1, NULL, 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (2, 2, 1, 2, 'In Transit', TIMESTAMP '2025-03-15 12:05:11.159', 2, 'Party Express', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (3, 3, 1, 3, 'Delivered', TIMESTAMP '2025-03-15 12:05:11.164', 3, 'Happy Delivery', 150, 2.5, TIMESTAMP '2025-03-15 09:05:11.164', 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (4, 4, 4, 4, 'Cancelled', TIMESTAMP '2025-03-15 12:05:11.168', 4, 'Silly Shipping', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (5, 5, 5, 5, 'On Hold', TIMESTAMP '2025-03-15 12:05:11.173', 5, 'Joyful Delivery', 500, 5, NULL, 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (6, 6, 6, 6, 'Completed', TIMESTAMP '2025-03-15 12:05:11.178', 6, 'Cheerful Delivery', 100, 1, TIMESTAMP '2025-03-15 09:05:11.178', 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (7, 7, 7, 7, 'Returned', TIMESTAMP '2025-03-15 12:05:11.183', 7, 'Happy Returns', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (8, 8, 8, 8, 'Lost', TIMESTAMP '2025-03-15 12:05:11.187', 8, 'Express Delivery', 150, 2.5, NULL, 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (9, 9, 9, 9, 'Awaiting Pickup', TIMESTAMP '2025-03-15 12:05:11.192', 9, 'Joyful Pickup', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (10, 10, 10, 10, 'Exception', TIMESTAMP '2025-03-15 12:05:11.196', 10, 'Silly Shipping', 500, 5, NULL, 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (25, 2, 2, 2, 'In Transit', TIMESTAMP '2025-04-14 09:35:55.902', 2, 'Party Express', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (27, 4, 4, 4, 'Cancelled', TIMESTAMP '2025-04-14 09:35:58.682', 4, 'Silly Shipping', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (28, 5, 5, 5, 'On Hold', TIMESTAMP '2025-04-14 09:35:59.327', 5, 'Joyful Delivery', 500, 5, TIMESTAMP '2024-10-14 06:35:59.000', 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (29, 6, 6, 6, 'Completed', TIMESTAMP '2025-04-14 09:35:59.946', 6, 'Cheerful Delivery', 100, 1, TIMESTAMP '2024-04-14 06:35:59.000', 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (30, 7, 7, 7, 'Returned', TIMESTAMP '2025-04-14 09:36:00.724', 7, 'Happy Returns', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (31, 8, 8, 8, 'Lost', TIMESTAMP '2025-04-14 09:36:01.378', 8, 'Express Delivery', 150, 2.5, TIMESTAMP '2025-03-30 06:36:01.000', 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (34, 2, 2, 2, 'In Transit', TIMESTAMP '2025-04-14 09:36:04.442', 2, 'Party Express', 200, 3, TIMESTAMP '2025-02-28 06:36:04.000', 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (37, 4, 4, 4, 'Cancelled', TIMESTAMP '2025-04-14 09:36:08.770', 4, 'Silly Shipping', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (38, 5, 5, 5, 'On Hold', TIMESTAMP '2025-04-14 09:36:09.593', 5, 'Joyful Delivery', 500, 5, TIMESTAMP '2025-03-14 06:36:09.000', 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (39, 6, 6, 6, 'Completed', TIMESTAMP '2025-04-14 09:36:10.330', 6, 'Cheerful Delivery', 100, 1, TIMESTAMP '2024-04-14 06:36:10.000', 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (40, 7, 7, 7, 'Returned', TIMESTAMP '2025-04-14 09:36:11.151', 7, 'Happy Returns', 200, 3, TIMESTAMP '2025-02-13 06:36:11.000', 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (41, 8, 8, 8, 'Lost', TIMESTAMP '2025-04-14 09:36:11.883', 8, 'Express Delivery', 150, 2.5, TIMESTAMP '2025-01-29 06:36:11.000', 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (72, 2, 2, 2, 'In Transit', TIMESTAMP '2025-04-16 09:17:06.206', 2, 'Party Express', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (73, 4, 4, 4, 'Cancelled', TIMESTAMP '2025-04-16 09:17:08.092', 4, 'Silly Shipping', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (74, 7, 7, 7, 'Returned', TIMESTAMP '2025-04-16 09:17:09.836', 7, 'Happy Returns', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (42, 1, 1, 1, 'Completed', TIMESTAMP '2025-04-20 10:00:00', 1, 'Standard', 100, 1, NULL, 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (43, 2, 1, 2, 'In Transit', TIMESTAMP '2025-04-20 10:05:00', 2, 'Express', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (44, 3, 1, 3, 'Delivered', TIMESTAMP '2025-04-20 10:10:00', 3, 'Same Day', 150, 2.5, TIMESTAMP '2025-04-20 09:00:00', 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (45, 4, 4, 4, 'Cancelled', TIMESTAMP '2025-04-20 10:15:00', 4, 'Standard', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (46, 5, 5, 5, 'On Hold', TIMESTAMP '2025-04-20 10:20:00', 5, 'Express', 500, 5, NULL, 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (47, 6, 6, 6, 'Completed', TIMESTAMP '2025-04-20 10:25:00', 6, 'Same Day', 100, 1, TIMESTAMP '2025-04-20 09:05:00', 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (48, 7, 7, 7, 'Returned', TIMESTAMP '2025-04-20 10:30:00', 7, 'Standard', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (49, 8, 8, 8, 'Lost', TIMESTAMP '2025-04-20 10:35:00', 8, 'Express', 150, 2.5, NULL, 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (50, 9, 9, 9, 'Awaiting Pickup', TIMESTAMP '2025-04-20 10:40:00', 9, 'Same Day', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (51, 10, 10, 10, 'Exception', TIMESTAMP '2025-04-20 10:45:00', 10, 'Standard', 500, 5, NULL, 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (52, 1, 1, 11, 'Completed', TIMESTAMP '2025-04-20 10:50:00', 1, 'Express', 100, 1, NULL, 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (53, 2, 1, 12, 'In Transit', TIMESTAMP '2025-04-20 10:55:00', 2, 'Same Day', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (54, 3, 1, 13, 'Delivered', TIMESTAMP '2025-04-20 11:00:00', 3, 'Standard', 150, 2.5, TIMESTAMP '2025-04-20 09:00:00', 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (55, 4, 4, 14, 'Cancelled', TIMESTAMP '2025-04-20 11:05:00', 4, 'Express', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (56, 5, 5, 15, 'On Hold', TIMESTAMP '2025-04-20 11:10:00', 5, 'Same Day', 500, 5, NULL, 35, 105.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (57, 6, 6, 16, 'Completed', TIMESTAMP '2025-04-20 11:15:00', 6, 'Standard', 100, 1, TIMESTAMP '2025-04-20 09:05:00', 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (58, 7, 7, 17, 'Returned', TIMESTAMP '2025-04-20 11:20:00', 7, 'Express', 200, 3, NULL, 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (59, 8, 8, 18, 'Lost', TIMESTAMP '2025-04-20 11:25:00', 8, 'Same Day', 150, 2.5, NULL, 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (60, 9, 9, 19, 'Awaiting Pickup', TIMESTAMP '2025-04-20 11:30:00', 9, 'Standard', 300, 4, NULL, 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (61, 10, 10, 20, 'Exception', TIMESTAMP '2025-04-20 11:35:00', 10, 'Express', 500, 5, NULL, 35, 105.00);

-- Example data for January to April for each service (1 to 20)

-- January Data
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (62, 1, 1, 1, 'Completed', TIMESTAMP '2025-01-01 10:00:00', 1, 'Standard', 100, 1, TIMESTAMP '2025-01-02 10:00:00', 10, 30.00);
-- repeat for other service IDs...

-- February Data
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (63, 2, 1, 2, 'In Transit', TIMESTAMP '2025-02-01 10:00:00', 2, 'Express', 200, 3, TIMESTAMP '2025-02-02 10:00:00', 20, 60.00);
-- repeat for other service IDs...

-- March Data
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (64, 3, 1, 3, 'Delivered', TIMESTAMP '2025-03-01 10:00:00', 3, 'Same Day', 150, 2.5, TIMESTAMP '2025-03-02 10:00:00', 15, 45.00);
-- repeat for other service IDs...

-- April Data
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (65, 4, 4, 4, 'Cancelled', TIMESTAMP '2025-04-01 10:00:00', 4, 'Standard', 300, 4, TIMESTAMP '2025-04-02 10:00:00', 25, 75.00);
-- repeat for other service IDs...

-- Completed Orders with various service_ids

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (66, 1, 1, 1, 'Completed', TIMESTAMP '2025-01-10 10:00:00', 1, 'Standard', 150, 1, TIMESTAMP '2025-01-11 10:00:00', 12, 35.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (67, 2, 2, 2, 'Completed', TIMESTAMP '2025-02-12 10:00:00', 2, 'Express', 200, 3, TIMESTAMP '2025-02-13 10:00:00', 25, 70.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (68, 3, 3, 3, 'Completed', TIMESTAMP '2025-03-14 10:00:00', 3, 'Same Day', 175, 2.5, TIMESTAMP '2025-03-15 10:00:00', 15, 45.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (69, 4, 4, 4, 'Completed', TIMESTAMP '2025-04-16 10:00:00', 4, 'Standard', 300, 4, TIMESTAMP '2025-04-17 10:00:00', 20, 60.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (70, 5, 5, 5, 'Completed', TIMESTAMP '2025-01-20 10:00:00', 5, 'Express', 250, 5, TIMESTAMP '2025-01-21 10:00:00', 30, 90.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (71, 6, 6, 6, 'Completed', TIMESTAMP '2025-02-22 10:00:00', 6, 'Same Day', 180, 1.5, TIMESTAMP '2025-02-23 10:00:00', 10, 30.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (76, 7, 7, 7, 'Completed', TIMESTAMP '2025-03-24 10:00:00', 7, 'Standard', 220, 3.5, TIMESTAMP '2025-03-25 10:00:00', 20, 50.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (77, 8, 8, 8, 'Completed', TIMESTAMP '2025-04-26 10:00:00', 8, 'Express', 160, 2.0, TIMESTAMP '2025-04-27 10:00:00', 15, 40.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (78, 9, 9, 9, 'Completed', TIMESTAMP '2025-01-30 10:00:00', 9, 'Same Day', 290, 4.0, TIMESTAMP '2025-01-31 10:00:00', 25, 75.00);

INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (75, 10, 10, 10, 'Completed', TIMESTAMP '2025-02-15 10:00:00', 10, 'Standard', 320, 5.0, TIMESTAMP '2025-02-16 10:00:00', 30, 80.00);

-- Adding completed orders for each service (1 to 20) for January to April

-- January Completed Orders
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (79, 1, 1, 1, 'Completed', TIMESTAMP '2025-01-05 10:00:00', 1, 'Standard', 200, 2, TIMESTAMP '2025-01-06 10:00:00', 15, 45.00);
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (80, 2, 1, 2, 'Completed', TIMESTAMP '2025-01-12 10:00:00', 2, 'Express', 250, 3, TIMESTAMP '2025-01-13 10:00:00', 20, 60.00);
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (81, 3, 1, 3, 'Completed', TIMESTAMP '2025-01-18 10:00:00', 3, 'Same Day', 300, 4, TIMESTAMP '2025-01-19 10:00:00', 25, 75.00);
-- Repeat similar inserts for SERVICE_ID 4 to 20...

-- February Completed Orders
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (82, 4, 1, 4, 'Completed', TIMESTAMP '2025-02-05 10:00:00', 4, 'Standard', 400, 5, TIMESTAMP '2025-02-06 10:00:00', 30, 90.00);
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (83, 5, 1, 5, 'Completed', TIMESTAMP '2025-02-12 10:00:00', 5, 'Express', 150, 2, TIMESTAMP '2025-02-13 10:00:00', 12, 35.00);
-- Repeat similar inserts for SERVICE_ID 6 to 20...

-- March Completed Orders
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (84, 6, 1, 6, 'Completed', TIMESTAMP '2025-03-05 10:00:00', 6, 'Same Day', 350, 3, TIMESTAMP '2025-03-06 10:00:00', 25, 70.00);
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (85, 7, 1, 7, 'Completed', TIMESTAMP '2025-03-12 10:00:00', 7, 'Standard', 200, 2, TIMESTAMP '2025-03-13 10:00:00', 15, 45.00);
-- Repeat similar inserts for SERVICE_ID 8 to 20...

-- April Completed Orders
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (86, 8, 1, 8, 'Completed', TIMESTAMP '2025-04-05 10:00:00', 8, 'Express', 400, 5, TIMESTAMP '2025-04-06 10:00:00', 30, 90.00);
INSERT INTO ORDERS (ID, CLIENT_ID, DRIVER_ID, SERVICE_ID, STATUS, CREATED_AT, ROUTE, DELIVERY_TYPE, TOTAL_WEIGHT, TOTAL_VOLUME, DELIVERED_AT, FUEL_CONSUMPTION, FUEL_COST)
VALUES (87, 9, 1, 9, 'Completed', TIMESTAMP '2025-04-12 10:00:00', 9, 'Same Day', 250, 3, TIMESTAMP '2025-04-13 10:00:00', 20, 60.00);
-- Repeat similar inserts for SERVICE_ID 10 to 20...

SELECT * FROM orders;

-- 1.	Постройте при помощи конструкции MODEL запросы, которые разрабатывают план: 
-- план стоимости перевозок для каждого клиента на следующий год, 
-- учитывая рост стоимости затрат на 10% бензин по сравнению с
-- аналогичным месяцем прошлого года.

SELECT * FROM orders;
SELECT * FROM client;

WITH MonthlyCosts AS (
    SELECT
        o.CLIENT_ID,
        EXTRACT(MONTH FROM o.CREATED_AT) AS MONTH,
        SUM(s.BASE_RATE) AS BASE_COST,
        SUM(o.FUEL_COST) AS TOTAL_FUEL_COST,
        SUM(s.BASE_RATE) + SUM(o.FUEL_COST) * 1.10 AS ADJUSTED_COST -- 10% increase on fuel cost
    FROM
        ORDERS o
    JOIN
        SERVICES s ON o.SERVICE_ID = s.ID
    WHERE
        o.CREATED_AT >= ADD_MONTHS(TRUNC(SYSDATE, 'YEAR'), -12) -- Last year data
    GROUP BY
        o.CLIENT_ID,
        EXTRACT(MONTH FROM o.CREATED_AT)
),
AnnualPlan AS (
    SELECT
        c.ID AS CLIENT_ID,
        c.LOGIN,
        COALESCE(mc.MONTH, 0) AS MONTH,
        COALESCE(mc.ADJUSTED_COST, 0) AS ESTIMATED_COST
    FROM
        CLIENT c
    LEFT JOIN
        MonthlyCosts mc ON c.ID = mc.CLIENT_ID
)
SELECT
    CLIENT_ID,
    LOGIN,
    SUM(ESTIMATED_COST) AS TOTAL_ESTIMATED_COST
FROM
    AnnualPlan
GROUP BY
    CLIENT_ID, LOGIN
ORDER BY
    CLIENT_ID;
   SELECT * FROM orders;
-- 2.	Найдите при помощи конструкции MATCH_RECOGNIZE() данные, которые соответствуют шаблону: 
-- Рост, падение, рост предоставления для каждого вида услуг
WITH monthly_costs AS (
    SELECT 
        s.ID AS service_id,
        s.NAME AS service_name,
        EXTRACT(YEAR FROM o.DELIVERED_AT) AS year,
        EXTRACT(MONTH FROM o.DELIVERED_AT) AS month,
        COALESCE(SUM(s.BASE_RATE * r.DISTANCE), 0) AS total_cost,
        LAG(COALESCE(SUM(s.BASE_RATE * r.DISTANCE), 0), 1, 0) OVER (
            PARTITION BY s.ID 
            ORDER BY EXTRACT(YEAR FROM o.DELIVERED_AT), EXTRACT(MONTH FROM o.DELIVERED_AT)
        ) AS prev_month_cost
    FROM 
        SERVICES s
    LEFT JOIN ORDERS o ON o.SERVICE_ID = s.ID AND o.STATUS IN ('Delivered', 'Completed') AND o.DELIVERED_AT IS NOT NULL
    LEFT JOIN ROUTES r ON o.ROUTE = r.ID
    GROUP BY 
        s.ID,
        s.NAME,
        EXTRACT(YEAR FROM o.DELIVERED_AT),
        EXTRACT(MONTH FROM o.DELIVERED_AT)
)
SELECT 
    service_id,
    service_name,
    year,
    month,
    total_cost,
    COALESCE(prev_month_cost, 0) AS prev_month_cost,
    CASE 
        WHEN prev_month_cost = 0 THEN 'No previous data'
        WHEN total_cost > prev_month_cost THEN 'Increase'
        WHEN total_cost < prev_month_cost THEN 'Decrease'
        ELSE 'No change'
    END AS cost_change,
    CASE 
        WHEN COALESCE(prev_month_cost, 0) = 0 THEN 0
        ELSE ROUND((total_cost - prev_month_cost) / prev_month_cost * 100, 2)
    END AS change_percentage
FROM 
    monthly_costs
ORDER BY 
    service_id,
    year,
    month;

SELECT * FROM CLIENT;
SELECT * FROM CLIENT_INFO; 
SELECT * FROM SERVICES;
SELECT * FROM ROUTES;
SELECT * FROM ORDERS;